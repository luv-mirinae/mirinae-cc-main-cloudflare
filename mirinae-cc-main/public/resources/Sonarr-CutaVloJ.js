import{_ as c,s as h,r as l,c as f,o as s,w as p,a as g,b as r,d as n,t as o}from"./index-NXnxvJjD.js";const m="/api/v3",d="/api",y={name:"Sonarr",mixins:[h],props:{item:Object},data:()=>({activity:null,missing:null,warnings:null,errors:null,serverError:!1}),computed:{apiPath(){return this.item.legacyApi?d:m}},created:function(){const t=parseInt(this.item.checkInterval,10)||0;t>0&&setInterval(()=>this.fetchConfig(),t),this.fetchConfig()},methods:{fetchConfig:function(){const t=e=>{console.error(e),this.serverError=!0};this.fetch(`${this.apiPath}/health?apikey=${this.item.apikey}`).then(e=>{this.warnings=e.filter(i=>i.type==="warning").length,this.errors=e.filter(i=>i.type==="errors").length}).catch(t),this.fetch(`${this.apiPath}/queue?apikey=${this.item.apikey}`).then(e=>{if(this.activity=0,this.item.legacyApi)for(var i=0;i<e.length;i++)e[i].series&&this.activity++;else this.activity=e.totalRecords}).catch(t),this.fetch(`${this.apiPath}/wanted/missing?apikey=${this.item.apikey}`).then(e=>{this.missing=e.totalRecords}).catch(t)}}},v={class:"notifs"},_={key:0,class:"notif activity",title:"Activity"},k={key:1,class:"notif missing",title:"Missing"},u={key:2,class:"notif warnings",title:"Warning"},w={key:3,class:"notif errors",title:"Error"},$={key:4,class:"notif errors",title:"Connection error to Sonarr API, check url and apikey in config.yml"};function C(t,e,i,I,A,E){const a=l("Generic");return s(),f(a,{item:i.item},{indicator:p(()=>[g("div",v,[t.activity>0?(s(),r("strong",_,o(t.activity),1)):n("",!0),t.missing>0?(s(),r("strong",k,o(t.missing),1)):n("",!0),t.warnings>0?(s(),r("strong",u,o(t.warnings),1)):n("",!0),t.errors>0?(s(),r("strong",w,o(t.errors),1)):n("",!0),t.serverError?(s(),r("strong",$," ? ")):n("",!0)])]),_:1},8,["item"])}const B=c(y,[["render",C],["__scopeId","data-v-2ecac434"]]);export{B as default};
